import{a as y,u as w,r as F,j as e,H as _,L as k}from"./app-6dzIbfSP.js";import{A as C,c as L}from"./AuthenticatedLayout-B5eLJUQz.js";import{P as S}from"./PrimaryButton-BqFGRUtD.js";import{I as c}from"./InputLabel-BXFkMCYN.js";import{T as x}from"./TextInput-Do6h9zRb.js";import{I as m}from"./InputError-BopX-n0N.js";import{C as l}from"./index.esm-Bs0fPYhF.js";import{S as n}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{S as A}from"./react-select.esm-CxG7AAqE.js";import{c as E}from"./cil-send-haInf9fd.js";import{c as I}from"./cib-addthis-BMGhLLu9.js";import"./transition-BVBwcrv7.js";import"./ApplicationLogo-CwtlBVjW.js";import"./logo-spwKF6je.js";function K({financements:o}){const p=y().props.auth.permissions,f=t=>p.some(s=>s.name==t),{data:d,setData:a,errors:i,post:h,processing:u}=w({financement_id:"",montant:"",document:""}),[r,g]=F.useState(null),j=t=>{a("financement_id",t.value);const s=o.data.find(N=>N.id===t.value);console.log("Financement sÃ©lectionnÃ© :",s),g(s.montant_r),a("montant",s.montant_r)},v=t=>{if(t.preventDefault(),console.log("Le montant saisi :",t.target.value),t.target.value>r){n.fire({icon:"info",text:`Le montant du financement est : ${r} FCFA`}),t.target.value=r;return}a("montant",t.target.value)},b=t=>{t.preventDefault(),h(route("backfinancement.store"),{onStart:()=>{n.fire({title:'<span style="color: #facc15;">ğŸ«  OpÃ©ration en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{n.showLoading()}})},onSuccess:()=>{n.close(),n.fire({title:'<span style="color: #2a7348;">ğŸ‘ŒOpÃ©ration rÃ©ussie </span>',text:"OpÃ©ration rÃ©ussie",confirmButtonText:"ğŸ˜‡ Fermer"})},onError:s=>{n.close(),n.fire({title:'<span style="color: #facc15;">ğŸ¤¦â€â™‚ï¸ OpÃ©ration Ã©chouÃ©e </span>',text:`${s.exception??"Veuillez vÃ©rifier vos informations et rÃ©essayer."}`,confirmButtonText:"ğŸ˜‡ Fermer"}),console.log(s)}})};return e.jsxs(C,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(l,{className:"text-success",icon:I})," Ajout des retour de financements"]}),children:[e.jsx(_,{title:"Ajouter un retour de financement"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsx("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",children:e.jsxs("div",{className:"bg-light p-3 rounded border mb-5",children:[f("backfinancement.view")?e.jsx("div",{className:" text-center  items-center gap-4",children:e.jsxs(k,{className:"btn btn-sm bg-success bg-hover text-white",href:route("backfinancement.index"),children:[" ",e.jsx(l,{icon:L})," Liste des retour des financements"]})}):null,e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(c,{htmlFor:"financement_id",value:"Financement",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(A,{placeholder:"Rechercher un financement ...",name:"financement_id",id:"financement_id",required:!0,className:"form-control mt-1 block w-full",options:o.data.map(t=>({value:t.id,label:`${t.reference}`})),value:o.data.map(t=>({value:t.id,label:`${t.reference}`})).find(t=>t.value===d.financement_id),onChange:t=>j(t)}),e.jsx(m,{className:"mt-2",message:i.financement_id})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(c,{htmlFor:"montant",value:"Le montant",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(x,{type:"number",id:"montant",className:"mt-1 block w-full",value:d.montant,placeholder:"Ex: 234567",onChange:t=>v(t),autoComplete:"montant",min:1,max:r,required:!0}),e.jsx(m,{className:"mt-2",message:i.montant})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(c,{htmlFor:"document",value:"Document(preuve)",children:" "}),e.jsx(x,{id:"document",type:"file",className:"mt-1 block w-full",onChange:t=>a("document",t.target.files[0]),autoComplete:"document"}),e.jsx(m,{className:"mt-2",message:i.document})]})})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(S,{disabled:u,children:[" ",e.jsx(l,{icon:E})," ",u?"Enregistrement ...":"Enregistrer"," "]})})]})]})})})})]})}export{K as default};
