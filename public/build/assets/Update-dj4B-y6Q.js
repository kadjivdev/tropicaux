import{a as J,r as j,u as V,j as e,H as U,L as G}from"./app-DwJdQDEM.js";import{A as K}from"./AuthenticatedLayout-BmoQNS8_.js";import{P as Q}from"./PrimaryButton-zHd7Ygo8.js";import{I as p}from"./InputLabel-CHcLn-I6.js";import{T as b}from"./TextInput-CFyfz3vb.js";import{I as d}from"./InputError-ChalJ9dL.js";import{C as m}from"./index.esm-CpO-k5Nx.js";import{S as v}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{S as x}from"./react-select.esm-ky557a7_.js";import{c as E}from"./cil-list-CLA-Txc1.js";import{c as $,J as F}from"./textarea-UFhtpcqG.js";import{c as A}from"./cil-cut-CHx8WcEc.js";import{c as W}from"./cib-addthis-BMGhLLu9.js";import{c as X}from"./cil-send-haInf9fd.js";import{c as Y}from"./cil-pencil-m516yCOw.js";import"./transition-JJWCyxps.js";import"./ApplicationLogo-gcVKP8-s.js";import"./logo-spwKF6je.js";import"./description-D4EMmnfV.js";function be({chargement:t,produits:g,convoyeurs:N,superviseurs:_,magasins:C,chauffeurs:y,fournisseurs:w,camions:k}){const P=J().props.auth.permissions,[S,I]=j.useState(1),[L,R]=j.useState(1),[r,u]=j.useState(t.details||[]),[n,f]=j.useState(t.camions||[]),O=s=>P.some(l=>l.name==s),{data:h,setData:c,errors:o,patch:D,processing:q}=V({produit_id:t.produit_id||"",chauffeur_id:t.chauffeur_id||"",superviseur_id:t.superviseur_id||"",convoyeur_id:t.convoyeur_id||"",magasin_id:t.magasin_id||"",adresse:t.adresse||"",observation:t.observation||"",details:r,camions:n}),T=s=>{s.preventDefault(),f([...n,{id:L,commentaire:""}]),R(L+1),console.log("initial lignes ",n)};j.useEffect(()=>{c("camions",n)},[n]);const M=s=>{let l=n.filter(function(a){return a.id!=s});f(l)},z=s=>{s.preventDefault(),u([...r,{id:S,fournisseur_id:"",sac_jute:"",sac_pp:"",tonnage:"",prix_achat:""}]),I(S+1),console.log("initial lignes ",r)};j.useEffect(()=>{c("details",r)},[r]);const B=s=>{let l=r.filter(function(a){return a.id!=s});u(l)},H=s=>{s.preventDefault(),D(route("chargement.update",t.id),{onStart:()=>{v.fire({title:'<span style="color: #facc15;">🫠 Opération en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{v.showLoading()}})},onSuccess:()=>{v.close(),v.fire({title:'<span style="color: #2a7348;">👌Opération réussie </span>',text:"Opération réussie",confirmButtonText:"😇 Fermer"})},onError:l=>{v.close(),v.fire({title:'<span style="color: #facc15;">🤦‍♂️ Opération échouée </span>',text:`${l.error??"Veuillez vérifier vos informations et réessayer."}`,confirmButtonText:"😇 Fermer"}),console.log(l)}})};return e.jsxs(K,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(m,{className:"text-success",icon:Y})," Modification du Chargement ",e.jsx("span",{className:"badge bg-light text-success border rounded",children:t.reference??"---"})]}),children:[e.jsx(U,{title:"Modifier un Chargement"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsx("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",children:e.jsxs("div",{className:"bg-light p-3 rounded border mb-5",children:[O("chargement.view")?e.jsx("div",{className:" text-center  items-center gap-4",children:e.jsxs(G,{className:"btn btn-sm bg-success bg-hover text-white",href:route("chargement.index"),children:[" ",e.jsx(m,{icon:E})," Liste des chargements"]})}):null,e.jsxs("form",{onSubmit:H,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs(p,{htmlFor:"produit_id",value:"Produit",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(x,{placeholder:"Rechercher un produit ...",name:"produit_id",id:"produit_id",required:!0,className:"form-control mt-1 block w-full",options:g.map(s=>({value:s.id,label:`${s.libelle}`})),value:g.map(s=>({value:s.id,label:`${s.libelle}`})).find(s=>s.value===h.produit_id),onChange:s=>c("produit_id",s.value)}),e.jsx(d,{className:"mt-2",message:o.produit_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(p,{htmlFor:"chauffeur_id",value:"Chauffeur",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(x,{placeholder:"Rechercher un chauffeur ...",name:"chauffeur_id",id:"chauffeur_id",required:!0,className:"form-control mt-1 block w-full",options:y.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:y.map(s=>({value:s.id,label:`${s.raison_sociale}`})).find(s=>s.value===h.chauffeur_id),onChange:s=>c("chauffeur_id",s.value)}),e.jsx(d,{className:"mt-2",message:o.chauffeur_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(p,{htmlFor:"magasin_id",value:"Magasin",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(x,{placeholder:"Rechercher un magasin ...",name:"magasin_id",id:"magasin_id",required:!0,className:"form-control mt-1 block w-full",options:C.map(s=>({value:s.id,label:`${s.libelle}`})),value:C.map(s=>({value:s.id,label:`${s.libelle}`})).find(s=>s.value===h.magasin_id),onChange:s=>c("magasin_id",s.value)}),e.jsx(d,{className:"mt-2",message:o.magasin_id})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs(p,{htmlFor:"superviseur_id",value:"Superviseur",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(x,{placeholder:"Rechercher un superviseur ...",name:"superviseur_id",id:"superviseur_id",required:!0,className:"form-control mt-1 block w-full",options:_.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:_.map(s=>({value:s.id,label:`${s.raison_sociale}`})).find(s=>s.value===h.superviseur_id),onChange:s=>c("superviseur_id",s.value)}),e.jsx(d,{className:"mt-2",message:o.superviseur_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"convoyeur_id",value:"Convoyeur"}),e.jsx(x,{placeholder:"Rechercher un convoyeur ...",name:"convoyeur_id",id:"convoyeur_id",className:"form-control mt-1 block w-full",options:N.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:N.map(s=>({value:s.id,label:`${s.raison_sociale}`})).find(s=>s.value===h.convoyeur_id),onChange:s=>c("convoyeur_id",s.value)}),e.jsx(d,{className:"mt-2",message:o.convoyeur_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(p,{htmlFor:"adresse",value:"Lieu de chargement",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(b,{type:"text",id:"adresse",className:"mt-1 block w-full",value:h.adresse,placeholder:"Abomey",onChange:s=>c("adresse",s.target.value),autoComplete:"adresse",min:1,required:!0}),e.jsx(d,{className:"mt-2",message:o.adresse})]})]})]}),e.jsx("br",{}),e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsxs("span",{className:"text-success",children:[e.jsx(m,{icon:$})," Détail des camions"]}),e.jsxs("button",{className:"btn btn-success bg-hover",onClick:s=>T(s),children:[" ",e.jsx(m,{className:"",icon:$})," Ajouter un camion"]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Camion"}),e.jsx("th",{scope:"col",children:"Commentaire"}),e.jsx("th",{scope:"col",children:"Action"})]})}),e.jsx("tbody",{id:"camion",children:n.length>0?n.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:e.jsx("div",{className:"mb-3",children:e.jsx(x,{placeholder:"Rechercher un camion ...",name:"magasin_id",className:"form-control mt-1 block w-full",options:k.map(a=>({value:a.id,label:a.libelle})),value:k.map(a=>({value:a.id,label:a.libelle})).find(a=>a.value===s.camion_id),onChange:a=>{const i=[...n];i[l].camion_id=a.value,f(i)},required:!0})})}),e.jsx("td",{children:e.jsx(F,{type:"text",className:"mt-1 block w-full form-control",value:s.commentaire,placeholder:"Ex : Ceci est le camion qui a éffectué au premier chargement",onChange:a=>{const i=[...n];i[l].commentaire=a.target.value,f(i)},required:!0})}),e.jsx("td",{className:"items-center",children:e.jsxs("button",{className:"btn btn-sm btn-danger shadow-sm rounded",onClick:()=>M(s.id),children:[" ",e.jsx(m,{icon:A})," "]})})]},l)):e.jsx("tr",{className:"text-center",children:e.jsxs("td",{colSpan:4,children:["Aucun camion disponible ",e.jsx(d,{className:"mt-2",message:o.camions})]})})})]}),e.jsx("br",{}),e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsxs("span",{className:"text-success",children:[e.jsx(m,{icon:E})," Détail du chargement"]}),e.jsxs("button",{className:"btn btn-success bg-hover",onClick:s=>z(s),children:[" ",e.jsx(m,{className:"",icon:W})," Ajouter"]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Fournisseur"}),e.jsx("th",{scope:"col",children:"Sac de Jute"}),e.jsx("th",{scope:"col",children:"Sac PP"}),e.jsx("th",{scope:"col",children:"Tonnage"}),e.jsx("th",{scope:"col",children:"Prix d'achat"}),e.jsx("th",{scope:"col",children:"Action"})]})}),e.jsx("tbody",{id:"lignes",children:r.length>0?r.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:e.jsx("div",{className:"mb-3",children:e.jsx(x,{placeholder:"Rechercher un fournisseur ...",name:"fournisseur_id",className:"form-control mt-1 block w-full",options:w.map(a=>({value:a.id,label:a.raison_sociale})),value:w.map(a=>({value:a.id,label:a.raison_sociale})).find(a=>a.value===s.fournisseur_id),onChange:a=>{const i=[...r];i[l].fournisseur_id=a.value,u(i)},required:!0})})}),e.jsx("td",{children:e.jsx(b,{type:"number",className:"mt-1 block w-full",value:s.sac_jute,placeholder:"Ex : 10",onChange:a=>{const i=[...r];i[l].sac_jute=a.target.value,u(i)},required:!0})}),e.jsx("td",{children:e.jsx(b,{type:"number",className:"mt-1 block w-full",value:s.sac_pp,placeholder:"Ex : 10",onChange:a=>{const i=[...r];i[l].sac_pp=a.target.value,u(i)},min:0,required:!0})}),e.jsx("td",{children:e.jsx(b,{type:"number",className:"mt-1 block w-full",value:s.tonnage,placeholder:"Ex : 10",onChange:a=>{const i=[...r];i[l].tonnage=a.target.value,u(i)},min:0,required:!0})}),e.jsx("td",{children:e.jsx(b,{type:"number",className:"mt-1 block w-full",value:s.prix_achat,placeholder:"Ex : 75.000",onChange:a=>{const i=[...r];i[l].prix_achat=a.target.value,u(i)},min:1,required:!0})}),e.jsx("td",{className:"items-center",children:e.jsxs("button",{className:"btn btn-sm btn-danger shadow-sm rounded",onClick:()=>B(s.id),children:[" ",e.jsx(m,{icon:A})," "]})})]},l)):e.jsx("tr",{className:"text-center",children:e.jsxs("td",{colSpan:7,children:["Aucune ligne disponible ",e.jsx(d,{className:"mt-2",message:o.details})]})})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"observation",value:"Observation",children:" "}),e.jsx(F,{id:"observation",type:"text",className:"mt-1 block w-full form-control",placeholder:"Laissez une observation ici ...",value:h.observation,onChange:s=>c("observation",s.target.value),autoComplete:"observation"}),e.jsx(d,{className:"mt-2",message:o.observation})]})})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(Q,{disabled:q,children:[" ",e.jsx(m,{icon:X})," ",q?"Enregistrement ...":"Enregistrer"," "]})})]})]})})})})]})}export{be as default};
