import{a as H,r as p,u as J,j as e,H as G,L as K}from"./app-C8t3Uf0R.js";import{A as Q,c as L}from"./AuthenticatedLayout-S4AoReI-.js";import{P as U}from"./PrimaryButton-bSxluTRj.js";import{I as x}from"./InputLabel-Cr90O3gy.js";import{T as b}from"./TextInput-C4ACyIyz.js";import{I as o}from"./InputError-D1HaxV_k.js";import{C as d}from"./index.esm-BGgip4Ka.js";import{S as h}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{S as g}from"./react-select.esm-BUfAF0ln.js";import{c as S}from"./cil-truck-DQWpTLfo.js";import{c as E}from"./cil-cut-CHx8WcEc.js";import{c as A}from"./cib-addthis-BMGhLLu9.js";import{c as W}from"./cil-send-haInf9fd.js";import{J as F}from"./textarea-ortwYUaG.js";import"./transition-Zf40MZMV.js";import"./ApplicationLogo-B3LUb2mE.js";import"./logo-spwKF6je.js";import"./description-Dtsjp8vD.js";function he({vente:i,partenaires:_,modes:N,camions:C,chargements:f}){const q=H().props.auth.permissions,[w,D]=p.useState(1),[y,I]=p.useState(1),O=f,[m,v]=p.useState(i.modes),[r,j]=p.useState(i.camions),P=s=>q.some(t=>t.name==s),{data:u,setData:l,errors:n,patch:$,processing:k}=J({partenaire_id:i.partenaire_id||"",chargement_id:i.chargement_id||"",prix:i.prix||"",montant:i.montant||"",document:i.partenaire_id||"",poids:i.poids||"",nbre_sac_rejete:i.nbre_sac_rejete||"",prix_unitaire_sac_rejete:i.prix_unitaire_sac_rejete||"",commentaire:i.commentaire||"",modes:m,camions:r}),R=s=>{s.preventDefault(),j([...r,{id:y,commentaire:""}]),I(y+1),console.log("initial lignes ",r)};p.useEffect(()=>{l("camions",r)},[r]);const T=(s,t)=>{s.preventDefault();let a=r.filter(function(c){return c.id!=t});j(a)},z=s=>{s.preventDefault(),v([...m,{id:w,paiement_mode_id:""}]),D(w+1),console.log("initial lignes ",m)};p.useEffect(()=>{l("modes",m)},[m]);const B=s=>{let t=m.filter(function(a){return a.id!=s});v(t)},M=s=>{s.preventDefault(),console.log("Data en json",u),$(route("vente.update",i.id),{onStart:()=>{h.fire({title:'<span style="color: #facc15;">ğŸ«  OpÃ©ration en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{h.showLoading()}})},onSuccess:()=>{h.close(),h.fire({title:'<span style="color: #2a7348;">ğŸ‘ŒOpÃ©ration rÃ©ussie </span>',text:"OpÃ©ration rÃ©ussie",confirmButtonText:"ğŸ˜‡ Fermer"})},onError:t=>{h.close(),h.fire({title:'<span style="color: #facc15;">ğŸ¤¦â€â™‚ï¸ OpÃ©ration Ã©chouÃ©e </span>',text:`${t.error??"Veuillez vÃ©rifier vos informations et rÃ©essayer."}`,confirmButtonText:"ğŸ˜‡ Fermer"}),console.log(t)}})},V=s=>{l("chargement_id",s.value);let t=O.find(a=>a.id==s.value);j(t.camions)};return e.jsxs(Q,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(d,{className:"text-success",icon:A})," Ajout des Ventes"]}),children:[e.jsx(G,{title:"Ajouter une vente"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsx("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",children:e.jsxs("div",{className:"bg-light p-3 rounded border mb-5",children:[P("vente.view")?e.jsx("div",{className:" text-center  items-center gap-4",children:e.jsxs(K,{className:"btn btn-sm bg-success bg-hover text-white",href:route("vente.index"),children:[" ",e.jsx(d,{icon:L})," Liste des ventes"]})}):null,e.jsxs("form",{onSubmit:M,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs(x,{htmlFor:"partenaire_id",value:"Partenaire",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(g,{placeholder:"Rechercher un partenaire ...",name:"partenaire_id",id:"partenaire_id",required:!0,className:"form-control mt-1 block w-full",options:_.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:_.map(s=>({value:s.id,label:`${s.raison_sociale}`})).find(s=>s.value===u.partenaire_id),onChange:s=>l("partenaire_id",s.value)}),e.jsx(o,{className:"mt-2",message:n.partenaire_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(x,{htmlFor:"prix",value:"Le Prix",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(b,{type:"number",id:"prix",className:"mt-1 block w-full",value:u.prix,placeholder:"Ex: 78000",onChange:s=>l("prix",s.target.value),autoComplete:"prix",min:1,required:!0}),e.jsx(o,{className:"mt-2",message:n.prix})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{htmlFor:"document",value:"Document(preuve)"}),e.jsx(b,{type:"file",id:"document",className:"mt-1 block w-full",onChange:s=>l("document",s.target.files[0]),autoComplete:"document"}),e.jsx(o,{className:"mt-2",message:n.document})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs(x,{htmlFor:"poids",value:"Le poids",children:[" ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(b,{type:"number",id:"poids",className:"mt-1 block w-full",value:u.poids,placeholder:"Ex: 30.0",onChange:s=>{l("poids",s.target.value)},autoComplete:"poids",required:!0,min:1}),e.jsx(o,{className:"mt-2",message:n.poids})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{htmlFor:"nbre_sac_rejete",value:"Sacs rejetÃ©"}),e.jsx(b,{type:"number",id:"nbre_sac_rejete",className:"mt-1 block w-full",value:u.nbre_sac_rejete,placeholder:"Ex: 3.0",onChange:s=>l("nbre_sac_rejete",s.target.value),autoComplete:"nbre_sac_rejete",min:1}),e.jsx(o,{className:"mt-2",message:n.nbre_sac_rejete})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{htmlFor:"prix_unitaire_sac_rejete",value:"Prix unitaire de Sacs rejetÃ©"}),e.jsx(b,{type:"number",id:"prix_unitaire_sac_rejete",className:"mt-1 block w-full",value:u.prix_unitaire_sac_rejete,placeholder:"Ex: 3.0",onChange:s=>l("prix_unitaire_sac_rejete",s.target.value),autoComplete:"prix_unitaire_sac_rejete",min:1}),e.jsx(o,{className:"mt-2",message:n.prix_unitaire_sac_rejete})]})]})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(x,{htmlFor:"chargement_id",value:"Le Chargement concernÃ©",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(g,{placeholder:"Rechercher un chargement ...",name:"chargement_id",id:"chargement_id",required:!0,className:"form-control mt-1 block w-full",options:f.map(s=>({value:s.id,label:`${s.reference}`})),value:f.map(s=>({value:s.id,label:`${s.reference}`})).find(s=>s.value===u.chargement_id),onChange:s=>V(s)}),e.jsx(o,{className:"mt-2",message:n.chargement_id})]})})}),e.jsx("br",{}),e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsxs("span",{className:"text-success",children:[e.jsx(d,{icon:S})," DÃ©tail des camions"]}),e.jsxs("button",{className:"btn btn-success bg-hover",onClick:s=>R(s),children:[" ",e.jsx(d,{className:"",icon:S})," Ajouter un camion"]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"NÂ°"}),e.jsx("th",{scope:"col",children:"Camion"}),e.jsx("th",{scope:"col",children:"Commentaire"}),e.jsx("th",{scope:"col",children:"Action"})]})}),e.jsx("tbody",{id:"camion",children:r.length>0?r.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx("div",{className:"mb-3",children:e.jsx(g,{placeholder:"Rechercher un camion ...",className:"form-control mt-1 block w-full",options:C.map(a=>({value:a.id,label:a.libelle})),value:C.map(a=>({value:a.id,label:a.libelle})).find(a=>a.value===s.camion_id),onChange:a=>{const c=[...r];c[t].camion_id=a.value,j(c)},required:!0})})}),e.jsx("td",{children:e.jsx(F,{type:"text",className:"mt-1 block w-full form-control",value:s.commentaire,placeholder:"Ex : Ceci est le camion qui a Ã©ffectuÃ© au premier chargement",onChange:a=>{const c=[...r];c[t].commentaire=a.target.value,j(c)},required:!0})}),e.jsx("td",{className:"items-center",children:e.jsxs("button",{className:"btn btn-sm btn-danger shadow-sm rounded",onClick:a=>T(a,s.id),children:[" ",e.jsx(d,{icon:E})," "]})})]},t)):e.jsx("tr",{className:"text-center",children:e.jsxs("td",{colSpan:4,children:["Aucun camion disponible ",e.jsx(o,{className:"mt-2",message:n.camions})]})})})]}),e.jsx("br",{}),e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsxs("span",{className:"text-success",children:[e.jsx(d,{icon:L})," Modes de paiements"]}),e.jsxs("button",{className:"btn btn-success bg-hover",onClick:s=>z(s),children:[" ",e.jsx(d,{className:"",icon:A})," Ajouter un mode de paiement"]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"NÂ°"}),e.jsx("th",{scope:"col",children:"Mode de paiement"}),e.jsx("th",{scope:"col",children:"Action"})]})}),e.jsx("tbody",{id:"lignes",children:m.length>0?m.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx("div",{className:"mb-3",children:e.jsx(g,{placeholder:"Rechercher un mode de paiement ...",name:"paiement_mode_id",className:"form-control mt-1 block w-full",options:N.map(a=>({value:a.id,label:a.libelle})),value:N.map(a=>({value:a.id,label:a.libelle})).find(a=>a.value===s.paiement_mode_id),onChange:a=>{const c=[...m];c[t].paiement_mode_id=a.value,v(c)},required:!0})})}),e.jsx("td",{className:"items-center",children:e.jsxs("button",{className:"btn btn-sm btn-danger shadow-sm rounded",onClick:()=>B(s.id),children:[" ",e.jsx(d,{icon:E})," "]})})]},t)):e.jsx("tr",{className:"text-center",children:e.jsxs("td",{colSpan:3,children:["Aucun mode de paiement disponible ",e.jsx(o,{className:"mt-2",message:n.modes})]})})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{htmlFor:"commentaire",value:"Observation",children:" "}),e.jsx(F,{id:"commentaire",type:"text",className:"mt-1 block w-full form-control",placeholder:"Laissez une commentaire ici ...",value:u.observation,onChange:s=>l("commentaire",s.target.value),autoComplete:"commentaire"}),e.jsx(o,{className:"mt-2",message:n.commentaire})]})})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(U,{disabled:k,children:[" ",e.jsx(d,{icon:W})," ",k?"Enregistrement ...":"Enregistrer"," "]})})]})]})})})})]})}export{he as default};
