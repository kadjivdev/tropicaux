import{a as T,r as d,u as _,j as e,H as $,L as j}from"./app-CgScMw0Q.js";import{A,c as D}from"./AuthenticatedLayout-D5PxJdvq.js";import{C as c}from"./index.esm-QyQOMAAO.js";import{S as r}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{M as b,S as f}from"./SecondaryButton-BWW_1EBv.js";import{T as g}from"./TextInput-BgAOMNxJ.js";import{c as P}from"./cib-addthis-BMGhLLu9.js";import{c as F}from"./cil-menu-Za6MY1fF.js";import{c as O}from"./cil-pencil-m516yCOw.js";import{c as z}from"./cil-check-circle-BlU9eaow.js";import{c as N,J as E}from"./textarea-CTOIAV-s.js";import{c as i}from"./cil-list-CLA-Txc1.js";import{c as I}from"./cil-cloud-download-CPU_poQw.js";import"./transition-K7v_75eM.js";import"./ApplicationLogo-DfUcZac_.js";import"./logo-spwKF6je.js";import"./description-BVlDQ0Qs.js";function ce({ventes:y}){const w=T().props.auth.permissions,l=s=>w.some(t=>t.name==s),[n,x]=d.useState(null),[k,h]=d.useState(!1),[C,m]=d.useState(!1),v=(s,t)=>{s.preventDefault(),x(t),h(!0)},u=()=>{h(!1)},B=(s,t)=>{console.log("Current vente ",t),s.preventDefault(),x(t),m(!0)},p=()=>{m(!1)},{patch:S,delete:V}=_({}),M=(s,t)=>{s.preventDefault(),r.fire({title:'<span style="color: #facc15;">âš ï¸ ÃŠtes-vous sÃ»r ?</span>',text:`La vente (${t.reference}) sera supprimÃ©e de faÃ§on permanente !`,showCancelButton:!0,confirmButtonColor:"#2a7348",cancelButtonColor:"#3085d6",confirmButtonText:"ğŸ˜‡ Oui, supprimer !",cancelButtonText:"Annuler"}).then(a=>{a.isConfirmed&&(r.fire({title:'<span style="color: #facc15;">ğŸ«  Suppression en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}}),V(route("vente.destroy",t.id),{onSuccess:()=>{r.close(),r.fire({title:'<span style="color: #2a7348;">ğŸ‘ŒSuppression rÃ©ussie </span>',text:"La vente a Ã©tÃ© supprimÃ©e avec succÃ¨s.",confirmButtonText:"ğŸ˜‡ Fermer"})},onError:o=>{r.close(),r.fire({title:'<span style="color: #facc15;">ğŸ¤¦â€â™‚ï¸ Suppression Ã©chouÃ©e </span>',text:`${o.exception??"Veuillez rÃ©essayer."}`,confirmButtonText:"ğŸ˜‡ Fermer"})}}))})},L=(s,t)=>{s.preventDefault(),r.fire({title:'<span style="color: #facc15;">âš ï¸ ÃŠtes-vous sÃ»r ?</span>',text:`La vente (${t.reference}) sera validÃ©e de faÃ§on permanente !`,showCancelButton:!0,confirmButtonColor:"#2a7348",cancelButtonColor:"#3085d6",confirmButtonText:"ğŸ˜‡ Oui, Valider !",cancelButtonText:"Annuler"}).then(a=>{a.isConfirmed&&(r.fire({title:'<span style="color: #facc15;">ğŸ«  Validation en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}}),S(route("vente.validate",t.id),{onSuccess:()=>{r.close(),r.fire({title:'<span style="color: #2a7348;">Validation rÃ©ussie </span>',text:`La vente (${t.reference}) a Ã©tÃ© validÃ©e avec succÃ¨s.`,confirmButtonText:"ğŸ˜‡ Fermer"})},onError:o=>{r.close(),r.fire({title:'<span style="color: #facc15;">ğŸ¤¦â€â™‚ï¸ Validation Ã©chouÃ©e </span>',text:`${o.exception??"Veuillez rÃ©essayer."}`,confirmButtonText:"ğŸ˜‡ Fermer"})}}))})};return e.jsxs(A,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(c,{className:"text-success",icon:i})," Gestion des ventes"]}),children:[e.jsx($,{title:"Les Ventes"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsxs("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",style:{overflowX:"auto"},children:[l("vente.create")?e.jsx("div",{className:"text-center  items-center gap-4",children:e.jsxs(j,{className:"btn w-50 bg-success bg-hover text-white",href:route("vente.create"),children:[" ",e.jsx(c,{className:"",icon:P})," Ajouter"]})}):null,e.jsxs("table",{className:"table table-striped",id:"myTable",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"NÂ°"}),e.jsx("th",{scope:"col",children:"Action"}),e.jsx("th",{scope:"col",children:"Reference"}),e.jsx("th",{scope:"col",children:"Partenaire"}),e.jsx("th",{scope:"col",children:"Camions"}),e.jsx("th",{scope:"col",children:"Mode paiements"}),e.jsx("th",{scope:"col",children:"Prix"}),e.jsx("th",{scope:"col",children:"Poids"}),e.jsx("th",{scope:"col",children:"Nbre Sac rejete"}),e.jsx("th",{scope:"col",children:"Prix unit Sac rejete"}),e.jsx("th",{scope:"col",children:"Montant"}),e.jsx("th",{scope:"col",children:"Montant Total"}),e.jsx("th",{scope:"col",children:"Commentaire"}),e.jsx("th",{scope:"col",children:"Preuve"}),e.jsx("th",{scope:"col",children:"InsÃ©rÃ© par"}),e.jsx("th",{scope:"col",children:"ValidÃ© le"}),e.jsx("th",{scope:"col",children:"ValidÃ© par"})]})}),e.jsx("tbody",{children:y.data.map((s,t)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:t+1}),e.jsx("td",{children:s.validated_at?"---":e.jsxs("div",{className:"dropstart",children:[e.jsxs("button",{className:"dropdown-toggle inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none dark:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx(c,{icon:F})," GÃ©rer"]}),e.jsxs("ul",{className:"dropdown-menu p-2 border rounded shadow",children:[e.jsx("li",{children:l("vente.edit")&&e.jsxs(j,{className:"btn text-warning",href:route("vente.edit",s.id),children:[e.jsx(c,{icon:O})," Modifier"]})}),e.jsx("li",{children:l("vente.validate")&&e.jsxs("button",{type:"button",className:"btn text-success",onClick:a=>L(a,s),children:[e.jsx(c,{icon:z})," Valider"]})}),e.jsx("li",{children:l("vente.delete")&&e.jsxs("button",{type:"button",className:"btn text-danger",onClick:a=>M(a,s),children:[e.jsx(c,{icon:D})," Supprimer"]})})]})]})}),e.jsxs("td",{children:[" ",e.jsxs("span",{className:"badge bg-light border rounded text-dark",children:[" ",s.reference," "]})]}),e.jsx("td",{children:s?.partenaire?.raison_sociale??"---"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-light border shadow-sm rounded text-success",onClick:a=>v(a,s),children:e.jsx(c,{icon:N})})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-light border shadow-sm rounded text-success",href:"#",onClick:a=>B(a,s),children:e.jsx(c,{icon:i})})}),e.jsxs("td",{children:[" ",e.jsxs("span",{className:"badge bg-light border rounded text-dark",children:[" ",s.prix||"00"," "]})]}),e.jsxs("td",{children:[" ",e.jsxs("span",{className:"badge bg-light border rounded text-dark",children:[" ",s.poids||"00"," "]})]}),e.jsxs("td",{children:[" ",e.jsxs("span",{className:"badge bg-light border rounded text-dark",children:[" ",s.nbre_sac_rejete||"00"," "]})]}),e.jsxs("td",{children:[" ",e.jsxs("span",{className:"badge bg-light border rounded text-dark",children:[" ",s.prix_unitaire_sac_rejete||"00"," "]})]}),e.jsxs("td",{children:[" ",e.jsxs("span",{className:"badge bg-light border rounded text-dark",children:[" ",s.montant||"00"," "]})]}),e.jsxs("td",{children:[" ",e.jsxs("span",{className:"badge bg-light border rounded text-dark",children:[" ",s.montant_total||"00"," "]})]}),e.jsx("td",{children:e.jsx("textarea",{rows:1,className:"form-control",disabled:!0,placeholder:s.commentaire||"--"})}),e.jsx("td",{children:s.document?e.jsx("a",{className:"btn btn-sm shadow border rounded text-dark",target:"_blank",href:s.document,children:e.jsx(c,{className:"text-success",icon:I})}):e.jsx("span",{className:"text-muted",children:"---"})}),e.jsxs("td",{children:[" ",e.jsx("span",{className:"badge bg-light border rounded text-dark",children:`${s.createdBy?.firstname} - ${s.createdBy?.lastname}`})," "]}),e.jsxs("td",{children:[" ",e.jsx("span",{className:"badge bg-light border rounded text-dark",children:`${s.validated_at||"--"}`})," "]}),e.jsxs("td",{children:[" ",e.jsx("span",{className:"badge bg-light border rounded text-dark",children:`${s.validatedBy?.firstname||""} - ${s.validatedBy?.lastname||""}`})," "]})]},s.id))})]})]})})}),e.jsx(b,{show:k,onClose:u,children:e.jsxs("form",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:[e.jsx(c,{className:"text-success",icon:N})," Liste des camions de la vente ",e.jsx("span",{className:"badge bg-light rounded border shadow-sm text-success",children:n?.reference??"---"})]}),e.jsx("div",{className:"p-2",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"NÂ°"}),e.jsx("th",{scope:"col",children:"Camion"}),e.jsx("th",{scope:"col",children:"Commentaire"})]})}),e.jsx("tbody",{id:"camion",children:n?.camions.length>0?n?.camions.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx(g,{type:"text",className:"mt-1 block w-full form-control",value:s.camion?.libelle,disabled:!0})}),e.jsx("td",{children:e.jsx(E,{type:"text",className:"mt-1 block w-full form-control",value:s.commentaire,disabled:!0})})]},t)):e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:3,children:"Aucun camion disponible"})})})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(f,{className:"text-success",onClick:u,children:"Fermer"})})]})}),e.jsx(b,{show:C,onClose:p,children:e.jsxs("form",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:[e.jsx(c,{className:"text-success",icon:i})," Mode de paiement de la vente ",e.jsx("span",{className:"badge bg-light rounded border shadow-sm text-success",children:n?.reference??"---"})]}),e.jsx("div",{className:"p-2",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"NÂ°"}),e.jsx("th",{scope:"col",children:"Mode de paiement"})]})}),e.jsx("tbody",{id:"lignes",children:n?.modes.length>0?n?.modes.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx(g,{type:"text",className:"mt-1 block w-full",value:s.mode?.libelle,disabled:!0})})]},t)):e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:2,children:"Aucun dÃ©tail disponible "})})})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(f,{className:"text-success",onClick:p,children:"Fermer"})})]})})]})}export{ce as default};
