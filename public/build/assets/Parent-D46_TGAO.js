import{u as n,r as y,a as v,j as e,H as P}from"./app-nfLeNANc.js";import{A as k,c as C}from"./AuthenticatedLayout-D4xPlrRy.js";import{C as r}from"./index.esm-Ba7oQv2p.js";import{S as t}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{M as I,S}from"./SecondaryButton-oSiX9qi2.js";import{I as E}from"./InputLabel-DqsbX5Yu.js";import{P as L}from"./PrimaryButton-B561h_ZN.js";import{T as M}from"./TextInput-PL1pBLGW.js";import{I as T}from"./InputError-BqJsdPiL.js";import{c,a as O}from"./cil-info-CGjZWabf.js";import{c as _}from"./cil-center-focus-Dy_g8s2j.js";import{c as A}from"./cil-send-haInf9fd.js";import"./transition-7DJbAyG0.js";import"./ApplicationLogo-c86NVzuI.js";import"./logo-CPzApIsd.js";function Y({users:d}){n().props.auth.user;const m=n().props.auth.permissions,[h,l]=y.useState(!1),x=s=>m.some(a=>a.name==s),p=s=>{s.preventDefault(),l(!0)},o=()=>{l(!1)},j=s=>{t.fire({text:`Profile de : ${s.firstname} - ${s.lastname}`,imageUrl:s.detail?.profile_img,imageWidth:400,imageHeight:200,imageAlt:"Photo de profile",confirmButtonColor:"#1b5a38",confirmButtonText:"Merci"})},{data:B,setData:f,errors:u,processing:i,post:g}=v({parents:""}),b=s=>{s.preventDefault(),t.fire({title:"Opération en cours...",text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{t.showLoading()}}),g(route("parent.import"),{onSuccess:()=>{t.close(),t.fire({icon:"success",title:"Opération réussie",text:"Importation effectuée avec succès"}),l(!1)},onError:a=>{t.close(),t.fire({icon:"error",title:"Opération échouée",text:`${a.exception??"Veuillez vérifier vos informations et réessayer."}`}),l(!1)}})};return e.jsxs(k,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(r,{className:"text-success",icon:C})," Panel des parents"]}),children:[e.jsx(P,{title:"Les Parents"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsxs("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",style:{overflowX:"auto"},children:[x("utilisateur.create")?e.jsx("div",{className:"items-center gap-4",children:e.jsxs("button",{className:"btn btn-sm bg-success bg-hover text-white",onClick:s=>p(s),children:[" ",e.jsx(r,{className:"",icon:c})," Importer des parents"]})}):null,e.jsxs("table",{className:"table table-striped",id:"myTable",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Profile"}),e.jsx("th",{scope:"col",children:"Ecole"}),e.jsx("th",{scope:"col",children:"Nom"}),e.jsx("th",{scope:"col",children:"Prénom"}),e.jsx("th",{scope:"col",children:"Email/Phone"}),e.jsx("th",{scope:"col",children:"Rôles"})]})}),e.jsx("tbody",{children:d.data.map((s,a)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:a+1}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-light border bg-hover shadow-sm",onClick:()=>j(s),children:e.jsx(r,{icon:_})})}),e.jsx("td",{children:s.school?.raison_sociale||"---"}),e.jsx("td",{children:s.firstname}),e.jsx("td",{children:s.lastname}),e.jsxs("td",{children:[s.email,"/",s.detail?.phone||"---"]}),e.jsx("td",{className:"text-center",children:s.roles?.length>0?s.roles.map((N,w)=>e.jsx("span",{className:"m-1 badge bg-light text-dark border rounded",children:N.name},w)):"---"})]},s.id))})]})]})})}),e.jsx(I,{show:h,onClose:o,children:e.jsxs("form",{onSubmit:b,className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:["Importation de nouveaux  ",e.jsx("em",{className:"text-success",children:" parents "})]}),e.jsxs("p",{className:"alert alert-success",children:[e.jsx(r,{className:"text-success",icon:O}),e.jsxs("ol",{className:"",children:[e.jsx("li",{className:"",children:"Télecharger le modèle"}),e.jsx("li",{className:"",children:"Remplissez le modèle"}),e.jsx("li",{className:"",children:"Uploader le fichier remplit"})]})]}),e.jsx("div",{className:"my-2",children:e.jsxs("a",{target:"_blank",href:"/parents-model.xlsx",className:"w-100 text-white btn btn-sm bg-success btn-hover",children:[e.jsx(r,{icon:c}),"Télécharger le modèle"]})}),e.jsxs("div",{className:"my-2",children:[e.jsxs(E,{htmlFor:"parents",value:"Les parents en fichier excel",children:[" ",e.jsx("span",{className:"text-danger",children:"*"}),"  "]}),e.jsx(M,{type:"file",name:"parents",id:"parents",required:!0,className:"form-control mt-1 block w-full",onChange:s=>f("parents",s.target.files[0])}),e.jsx(T,{className:"mt-2",message:u.parents})]}),e.jsxs("div",{className:"mt-6 flex justify-end",children:[e.jsx(S,{onClick:o,children:"Abandonner"}),e.jsxs(L,{disabled:i,children:[e.jsx(r,{icon:A})," ",i?"Enregistrement ...":"Enregistrer les modifications"]})]})]})})]})}export{Y as default};
