import{a as y,u as w,r as F,j as e,H as L,L as S}from"./app-CInOIcGx.js";import{A,c as C}from"./AuthenticatedLayout-DKAAxKgl.js";import{P as k}from"./PrimaryButton-CPSoxDl-.js";import{I as m}from"./InputLabel-D4Qtrfmm.js";import{T as x}from"./TextInput-C699_oz7.js";import{I as l}from"./InputError-DGS3jAoO.js";import{C as d}from"./index.esm-DWguF0ib.js";import{S as s}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{S as E}from"./react-select.esm-CjhJNa7_.js";import{c as I}from"./cil-send-haInf9fd.js";import{c as O}from"./cib-addthis-BMGhLLu9.js";import"./transition-Ag_lCGtm.js";import"./ApplicationLogo-BeGn9bkw.js";import"./logo-spwKF6je.js";function K({backfinancement:a,financements:i}){const f=y().props.auth.permissions,h=t=>f.some(n=>n.name==t);console.log("Le retour de financement concernÃ© :",a);const{data:u,setData:r,errors:c,patch:g,processing:p}=w({financement_id:a.financement_id||"",montant:a.financement_montant_r||""}),[o,j]=F.useState(a.financement_montant_r),v=t=>{r("financement_id",t.value);const n=i.data.find(_=>_.id===t.value);console.log("Financement sÃ©lectionnÃ© :",n),j(n.montant_r),r("montant",n.montant_r)},N=t=>{if(t.preventDefault(),console.log("Le montant saisi :",t.target.value),t.target.value>o){s.fire({icon:"info",text:`Le montant du financement est : ${o} FCFA`}),t.target.value=o;return}r("montant",t.target.value)},b=t=>{t.preventDefault(),g(route("backfinancement.update",a.id),{onStart:()=>{s.fire({title:'<span style="color: #facc15;">ğŸ«  OpÃ©ration en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos donnÃ©es.",allowOutsideClick:!1,didOpen:()=>{s.showLoading()}})},onSuccess:()=>{s.close(),s.fire({title:'<span style="color: #2a7348;">ğŸ‘ŒOpÃ©ration rÃ©ussie </span>',text:"OpÃ©ration rÃ©ussie",confirmButtonText:"ğŸ˜‡ Fermer"})},onError:n=>{s.close(),s.fire({title:'<span style="color: #facc15;">ğŸ¤¦â€â™‚ï¸ OpÃ©ration Ã©chouÃ©e </span>',text:`${n.exception??"Veuillez vÃ©rifier vos informations et rÃ©essayer."}`,confirmButtonText:"ğŸ˜‡ Fermer"}),console.log(n)}})};return e.jsxs(A,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(d,{className:"text-success",icon:O})," Ajout des retour de financements"]}),children:[e.jsx(L,{title:"Ajouter un retour de financement"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsx("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",children:e.jsxs("div",{className:"bg-light p-3 rounded border mb-5",children:[h("backfinancement.view")?e.jsx("div",{className:" text-center  items-center gap-4",children:e.jsxs(S,{className:"btn btn-sm bg-success bg-hover text-white",href:route("backfinancement.index"),children:[" ",e.jsx(d,{icon:C})," Liste des retour des financements"]})}):null,e.jsxs("form",{onSubmit:b,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(m,{htmlFor:"financement_id",value:"Financement",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(E,{placeholder:"Rechercher un financement ...",name:"financement_id",id:"financement_id",required:!0,className:"form-control mt-1 block w-full",options:i.data.map(t=>({value:t.id,label:`${t.reference}`})),value:i.data.map(t=>({value:t.id,label:`${t.reference}`})).find(t=>t.value===u.financement_id),onChange:t=>v(t)}),e.jsx(l,{className:"mt-2",message:c.financement_id})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(m,{htmlFor:"montant",value:"Le montant",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(x,{type:"number",id:"montant",className:"mt-1 block w-full",value:u.montant,placeholder:"Ex: 234567",onChange:t=>N(t),autoComplete:"montant",min:1,max:o,required:!0}),e.jsx(l,{className:"mt-2",message:c.montant})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(m,{htmlFor:"document",value:"Document(preuve)",children:" "}),e.jsx(x,{id:"document",type:"file",className:"mt-1 block w-full",onChange:t=>r("document",t.target.files[0]),autoComplete:"document"}),e.jsx(l,{className:"mt-2",message:c.document})]})})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(k,{disabled:p,children:[" ",e.jsx(d,{icon:I})," ",p?"Enregistrement ...":"Enregistrer"," "]})})]})]})})})})]})}export{K as default};
