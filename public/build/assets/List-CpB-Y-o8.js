import{a as V,r as d,u as A,j as e,H as D,L as f}from"./app-Cc2JM5FI.js";import{A as $,c as M}from"./AuthenticatedLayout-6eIS-DxM.js";import{C as c}from"./index.esm-smRR20ck.js";import{S as r}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{M as b,S as g}from"./SecondaryButton-Dc-U8Jrf.js";import{T as a}from"./TextInput-CCtqa9iL.js";import{c as F}from"./cib-addthis-BMGhLLu9.js";import{c as O}from"./cil-menu-Za6MY1fF.js";import{c as P}from"./cil-pencil-m516yCOw.js";import{c as z}from"./cil-check-circle-BlU9eaow.js";import{c as y,J as E}from"./textarea-Bhm3U7FS.js";import{c as x}from"./cil-list-CLA-Txc1.js";import"./transition-CZVKrdTj.js";import"./ApplicationLogo-D24iTpvD.js";import"./logo-spwKF6je.js";import"./description-BgAxtlIb.js";function re({chargements:N}){const v=V().props.auth.permissions,o=s=>v.some(t=>t.name==s),[n,h]=d.useState(null),[w,u]=d.useState(!1),[C,m]=d.useState(!1),k=(s,t)=>{s.preventDefault(),h(t),u(!0)},p=()=>{u(!1)},S=(s,t)=>{console.log("Current chargement ",t),s.preventDefault(),h(t),m(!0)},j=()=>{m(!1)},{patch:B,delete:T}=A({}),L=(s,t)=>{s.preventDefault(),r.fire({title:'<span style="color: #facc15;">⚠️ Êtes-vous sûr ?</span>',text:"Le chargement sera supprimé de façon permanente !",showCancelButton:!0,confirmButtonColor:"#2a7348",cancelButtonColor:"#3085d6",confirmButtonText:"😇 Oui, supprimer !",cancelButtonText:"Annuler"}).then(l=>{l.isConfirmed&&(r.fire({title:'<span style="color: #facc15;">🫠 Suppression en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}}),T(route("chargement.destroy",t.id),{onSuccess:()=>{r.close(),r.fire({title:'<span style="color: #2a7348;">👌Suppression réussie </span>',text:"Le chargement a été supprimé avec succès.",confirmButtonText:"😇 Fermer"})},onError:i=>{r.close(),r.fire({title:'<span style="color: #facc15;">🤦‍♂️ Suppression échouée </span>',text:`${i.exception??"Veuillez réessayer."}`,confirmButtonText:"😇 Fermer"})}}))})},_=(s,t)=>{s.preventDefault(),r.fire({title:'<span style="color: #facc15;">⚠️ Êtes-vous sûr ?</span>',text:"Ce chargement sera validé de façon permanente !",showCancelButton:!0,confirmButtonColor:"#2a7348",cancelButtonColor:"#3085d6",confirmButtonText:"😇 Oui, Valider !",cancelButtonText:"Annuler"}).then(l=>{l.isConfirmed&&(r.fire({title:'<span style="color: #facc15;">🫠 Validation en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{r.showLoading()}}),B(route("chargement.validate",t.id),{onSuccess:()=>{r.close(),r.fire({title:'<span style="color: #2a7348;">Validation réussie </span>',text:"Le chargement a été validé avec succès.",confirmButtonText:"😇 Fermer"})},onError:i=>{r.close(),r.fire({title:'<span style="color: #facc15;">🤦‍♂️ Validation échouée </span>',text:`${i.exception??"Veuillez réessayer."}`,confirmButtonText:"😇 Fermer"})}}))})};return e.jsxs($,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(c,{className:"text-success",icon:x})," Gestion des chargements"]}),children:[e.jsx(D,{title:"Les chargements"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsxs("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",style:{overflowX:"auto"},children:[o("chargement.create")?e.jsx("div",{className:"text-center  items-center gap-4",children:e.jsxs(f,{className:"btn w-50 bg-success bg-hover text-white",href:route("chargement.create"),children:[" ",e.jsx(c,{className:"",icon:F})," Ajouter"]})}):null,e.jsxs("table",{className:"table table-striped",id:"myTable",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col text-center",children:"Action"}),e.jsx("th",{scope:"col",children:"Reference"}),e.jsx("th",{scope:"col",children:"Camions"}),e.jsx("th",{scope:"col",children:"Détails"}),e.jsx("th",{scope:"col",children:"Produit"}),e.jsx("th",{scope:"col",children:"Chauffeur"}),e.jsx("th",{scope:"col",children:"Superviseur"}),e.jsx("th",{scope:"col",children:"Magasin"}),e.jsx("th",{scope:"col",children:"Convoyeur"}),e.jsx("th",{scope:"col",children:"Adresse"}),e.jsx("th",{scope:"col",children:"Observation"}),e.jsx("th",{scope:"col",children:"Inséré par"}),e.jsx("th",{scope:"col",children:"Validé le"}),e.jsx("th",{scope:"col",children:"Validé par"})]})}),e.jsx("tbody",{children:N.data.map((s,t)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:t+1}),e.jsx("td",{children:s.validated_at?"---":e.jsxs("div",{className:"dropstart",children:[e.jsxs("button",{className:"dropdown-toggle inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none dark:bg-gray-800 dark:text-gray-400 dark:hover:text-gray-300",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx(c,{icon:O})," Gérer"]}),e.jsxs("ul",{className:"dropdown-menu p-2 border rounded shadow",children:[e.jsx("li",{children:o("chargement.edit")&&e.jsxs(f,{className:"btn text-warning",href:route("chargement.edit",s.id),children:[e.jsx(c,{icon:P})," Modifier"]})}),e.jsx("li",{children:o("chargement.validate")&&e.jsxs("button",{type:"button",className:"btn text-success",onClick:l=>_(l,s),children:[e.jsx(c,{icon:z})," Valider"]})}),e.jsx("li",{children:o("chargement.delete")&&e.jsxs("button",{type:"button",className:"btn text-danger",onClick:l=>L(l,s),children:[e.jsx(c,{icon:M})," Supprimer"]})})]})]})}),e.jsx("td",{className:"text-center",children:e.jsxs("span",{className:"badge bg-light rounded text-dark rounded shadow-sm",children:[" ",s?.reference??"---"]})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-light border shadow-sm rounded text-success",onClick:l=>k(l,s),children:e.jsx(c,{icon:y})})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-light border shadow-sm rounded text-success",href:"#",onClick:l=>S(l,s),children:e.jsx(c,{icon:x})})}),e.jsx("td",{children:s?.produit?.libelle??"---"}),e.jsx("td",{children:`${s?.chauffeur?.raison_sociale}`}),e.jsx("td",{children:`${s?.superviseur?.raison_sociale}`}),e.jsx("td",{children:s?.magasin?.libelle??"---"}),e.jsx("td",{children:`${s.convoyeur?.raison_sociale??"---"}`}),e.jsx("td",{children:s.adresse}),e.jsx("td",{children:s.observation}),e.jsxs("td",{children:[" ",e.jsx("span",{className:"badge bg-light border rounded text-dark",children:`${s.createdBy?.firstname} - ${s.createdBy?.lastname}`})," "]}),e.jsxs("td",{children:[" ",e.jsx("span",{className:"badge bg-light border rounded text-dark",children:`${s.validated_at||"--"}`})," "]}),e.jsxs("td",{children:[" ",e.jsx("span",{className:"badge bg-light border rounded text-dark",children:`${s.validatedBy?.firstname||""} - ${s.validatedBy?.lastname||""}`})," "]})]},s.id))})]})]})})}),e.jsx(b,{show:w,onClose:p,children:e.jsxs("form",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:[e.jsx(c,{className:"text-success",icon:y})," Liste des camions du chargement ",e.jsx("span",{className:"badge bg-light rounded border shadow-sm text-success",children:n?.reference??"---"})]}),e.jsx("div",{className:"p-2",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Camion"}),e.jsx("th",{scope:"col",children:"Commentaire"})]})}),e.jsx("tbody",{id:"camion",children:n?.camions.length>0?n?.camions.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx(a,{type:"text",className:"mt-1 block w-full form-control",value:s.camion?.libelle,disabled:!0})}),e.jsx("td",{children:e.jsx(E,{type:"text",className:"mt-1 block w-full form-control",value:s.commentaire,disabled:!0})})]},t)):e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:3,children:"Aucun camion disponible"})})})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(g,{className:"text-success",onClick:p,children:"Fermer"})})]})}),e.jsx(b,{show:C,onClose:j,children:e.jsxs("form",{className:"p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:[e.jsx(c,{className:"text-success",icon:x})," Détails du chargement ",e.jsx("span",{className:"badge bg-light rounded border shadow-sm text-success",children:n?.reference??"---"})]}),e.jsx("div",{className:"p-2",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Fournisseur"}),e.jsx("th",{scope:"col",children:"Sac de Jute"}),e.jsx("th",{scope:"col",children:"Sac PP"}),e.jsx("th",{scope:"col",children:"Tonnage"}),e.jsx("th",{scope:"col",children:"Prix d'achat"})]})}),e.jsx("tbody",{id:"lignes",children:n?.details.length>0?n?.details.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:t+1}),e.jsx("td",{children:e.jsx(a,{type:"text",className:"mt-1 block w-full",value:s.fournisseur?.raison_sociale,disabled:!0})}),e.jsx("td",{children:e.jsx(a,{type:"number",className:"mt-1 block w-full",value:s.sac_jute,disabled:!0})}),e.jsx("td",{children:e.jsx(a,{type:"number",className:"mt-1 block w-full",value:s.sac_pp,disabled:!0})}),e.jsx("td",{children:e.jsx(a,{type:"number",className:"mt-1 block w-full",value:s.tonnage,disabled:!0})}),e.jsx("td",{children:e.jsx(a,{type:"number",className:"mt-1 block w-full",value:s.prix_achat,disabled:!0})})]},t)):e.jsx("tr",{className:"text-center",children:e.jsx("td",{colSpan:6,children:"Aucun détail disponible "})})})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(g,{className:"text-success",onClick:j,children:"Fermer"})})]})})]})}export{re as default};
