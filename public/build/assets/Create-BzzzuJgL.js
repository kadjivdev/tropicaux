import{a as M,r as x,u as V,j as e,H as G,L as K}from"./app-DwJdQDEM.js";import{A as Q}from"./AuthenticatedLayout-BmoQNS8_.js";import{P as U}from"./PrimaryButton-zHd7Ygo8.js";import{I as h}from"./InputLabel-CHcLn-I6.js";import{T as v}from"./TextInput-CFyfz3vb.js";import{I as o}from"./InputError-ChalJ9dL.js";import{C as d}from"./index.esm-CpO-k5Nx.js";import{S as j}from"./sweetalert2.esm.all-Bj_ZQUAw.js";import{S as p}from"./react-select.esm-ky557a7_.js";import{c as q}from"./cil-list-CLA-Txc1.js";import{c as E,J as A}from"./textarea-UFhtpcqG.js";import{c as $}from"./cil-cut-CHx8WcEc.js";import{c as F}from"./cib-addthis-BMGhLLu9.js";import{c as W}from"./cil-send-haInf9fd.js";import"./transition-JJWCyxps.js";import"./ApplicationLogo-gcVKP8-s.js";import"./logo-spwKF6je.js";import"./description-D4EMmnfV.js";function xe({produits:f,convoyeurs:g,superviseurs:N,magasins:_,chauffeurs:C,fournisseurs:y,camions:w}){const I=M().props.auth.permissions,[k,P]=x.useState(1),[S,R]=x.useState(1),[i,m]=x.useState([]),[t,b]=x.useState([]),O=s=>I.some(l=>l.name==s),{data:u,setData:n,errors:c,post:D,processing:L}=V({produit_id:"",chauffeur_id:"",superviseur_id:"",convoyeur_id:"",magasin_id:"",adresse:"",observation:"",details:i,camions:t}),T=s=>{s.preventDefault(),b([...t,{id:S,commentaire:""}]),R(S+1),console.log("initial lignes ",t)};x.useEffect(()=>{n("camions",t)},[t]);const z=s=>{let l=t.filter(function(a){return a.id!=s});b(l)},B=s=>{s.preventDefault(),m([...i,{id:k,fournisseur_id:"",sac_jute:"",sac_pp:"",tonnage:"",prix_achat:""}]),P(k+1),console.log("initial lignes ",i)};x.useEffect(()=>{n("details",i)},[i]);const H=s=>{let l=i.filter(function(a){return a.id!=s});m(l)},J=s=>{s.preventDefault(),D(route("chargement.store"),{onStart:()=>{j.fire({title:'<span style="color: #facc15;">🫠 Opération en cours...</span>',text:"Veuillez patienter pendant que nous traitons vos données.",allowOutsideClick:!1,didOpen:()=>{j.showLoading()}})},onSuccess:()=>{j.close(),j.fire({title:'<span style="color: #2a7348;">👌Opération réussie </span>',text:"Opération réussie",confirmButtonText:"😇 Fermer"})},onError:l=>{j.close(),j.fire({title:'<span style="color: #facc15;">🤦‍♂️ Opération échouée </span>',text:`${l.error??"Veuillez vérifier vos informations et réessayer."}`,confirmButtonText:"😇 Fermer"}),console.log(l)}})};return e.jsxs(Q,{header:e.jsxs("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:[e.jsx(d,{className:"text-success",icon:F})," Ajout des Chargements"]}),children:[e.jsx(G,{title:"Ajouter un Chargement"}),e.jsx("div",{className:"row py-12 justify-content-center",children:e.jsx("div",{className:"col-md-10 bg-white p-4 shadow sm:rounded-lg sm:p-8 dark:bg-gray-800",children:e.jsx("div",{className:"mx-auto _max-w-7xl space-y-6 sm:px-6 lg:px-8 ",children:e.jsxs("div",{className:"bg-light p-3 rounded border mb-5",children:[O("chargement.view")?e.jsx("div",{className:" text-center  items-center gap-4",children:e.jsxs(K,{className:"btn btn-sm bg-success bg-hover text-white",href:route("chargement.index"),children:[" ",e.jsx(d,{icon:q})," Liste des chargements"]})}):null,e.jsxs("form",{onSubmit:J,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"produit_id",value:"Produit",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher un produit ...",name:"produit_id",id:"produit_id",required:!0,className:"form-control mt-1 block w-full",options:f.map(s=>({value:s.id,label:`${s.libelle}`})),value:f.map(s=>({value:s.id,label:`${s.libelle}`})).find(s=>s.value===u.produit_id),onChange:s=>n("produit_id",s.value)}),e.jsx(o,{className:"mt-2",message:c.produit_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"chauffeur_id",value:"Chauffeur",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher un chauffeur ...",name:"chauffeur_id",id:"chauffeur_id",required:!0,className:"form-control mt-1 block w-full",options:C.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:C.map(s=>({value:s.id,label:`${s.raison_sociale}`})).find(s=>s.value===u.chauffeur_id),onChange:s=>n("chauffeur_id",s.value)}),e.jsx(o,{className:"mt-2",message:c.chauffeur_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"magasin_id",value:"Magasin",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher un magasin ...",name:"magasin_id",id:"magasin_id",required:!0,className:"form-control mt-1 block w-full",options:_.map(s=>({value:s.id,label:`${s.libelle}`})),value:_.map(s=>({value:s.id,label:`${s.libelle}`})).find(s=>s.value===u.magasin_id),onChange:s=>n("magasin_id",s.value)}),e.jsx(o,{className:"mt-2",message:c.magasin_id})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"superviseur_id",value:"Superviseur",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(p,{placeholder:"Rechercher un superviseur ...",name:"superviseur_id",id:"superviseur_id",required:!0,className:"form-control mt-1 block w-full",options:N.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:N.map(s=>({value:s.id,label:`${s.raison_sociale}`})).find(s=>s.value===u.superviseur_id),onChange:s=>n("superviseur_id",s.value)}),e.jsx(o,{className:"mt-2",message:c.superviseur_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{htmlFor:"convoyeur_id",value:"Convoyeur"}),e.jsx(p,{placeholder:"Rechercher un convoyeur ...",name:"convoyeur_id",id:"convoyeur_id",className:"form-control mt-1 block w-full",options:g.map(s=>({value:s.id,label:`${s.raison_sociale}`})),value:g.map(s=>({value:s.id,label:`${s.raison_sociale}`})).find(s=>s.value===u.convoyeur_id),onChange:s=>n("convoyeur_id",s.value)}),e.jsx(o,{className:"mt-2",message:c.convoyeur_id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs(h,{htmlFor:"adresse",value:"Lieu de chargement",children:["  ",e.jsx("span",{className:"text-danger",children:"*"})," "]}),e.jsx(v,{type:"text",id:"adresse",className:"mt-1 block w-full",value:u.adresse,placeholder:"Abomey",onChange:s=>n("adresse",s.target.value),autoComplete:"adresse",min:1,required:!0}),e.jsx(o,{className:"mt-2",message:c.adresse})]})]})]}),e.jsx("br",{}),e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsxs("span",{className:"text-success",children:[e.jsx(d,{icon:E})," Détail des camions"]}),e.jsxs("button",{className:"btn btn-success bg-hover",onClick:s=>T(s),children:[" ",e.jsx(d,{className:"",icon:E})," Ajouter un camion"]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Camion"}),e.jsx("th",{scope:"col",children:"Commentaire"}),e.jsx("th",{scope:"col",children:"Action"})]})}),e.jsx("tbody",{id:"camion",children:t.length>0?t.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:e.jsx("div",{className:"mb-3",children:e.jsx(p,{placeholder:"Rechercher un camion ...",name:"magasin_id",className:"form-control mt-1 block w-full",options:w.map(a=>({value:a.id,label:a.libelle})),value:w.map(a=>({value:a.id,label:a.libelle})).find(a=>a.value===s.camion_id),onChange:a=>{const r=[...t];r[l].camion_id=a.value,b(r)},required:!0})})}),e.jsx("td",{children:e.jsx(A,{type:"text",className:"mt-1 block w-full form-control",value:s.commentaire,placeholder:"Ex : Ceci est le camion qui a éffectué au premier chargement",onChange:a=>{const r=[...t];r[l].commentaire=a.target.value,b(r)},required:!0})}),e.jsx("td",{className:"items-center",children:e.jsxs("button",{className:"btn btn-sm btn-danger shadow-sm rounded",onClick:()=>z(s.id),children:[" ",e.jsx(d,{icon:$})," "]})})]},l)):e.jsx("tr",{className:"text-center",children:e.jsxs("td",{colSpan:4,children:["Aucun camion disponible ",e.jsx(o,{className:"mt-2",message:c.camions})]})})})]}),e.jsx("br",{}),e.jsxs("div",{className:"d-flex",style:{justifyContent:"space-between"},children:[e.jsxs("span",{className:"text-success",children:[e.jsx(d,{icon:q})," Détail du chargement"]}),e.jsxs("button",{className:"btn btn-success bg-hover",onClick:s=>B(s),children:[" ",e.jsx(d,{className:"",icon:F})," Ajouter"]})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"N°"}),e.jsx("th",{scope:"col",children:"Fournisseur"}),e.jsx("th",{scope:"col",children:"Sac de Jute"}),e.jsx("th",{scope:"col",children:"Sac PP"}),e.jsx("th",{scope:"col",children:"Tonnage"}),e.jsx("th",{scope:"col",children:"Prix d'achat"}),e.jsx("th",{scope:"col",children:"Action"})]})}),e.jsx("tbody",{id:"lignes",children:i.length>0?i.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:e.jsx("div",{className:"mb-3",children:e.jsx(p,{placeholder:"Rechercher un fournisseur ...",name:"fournisseur_id",className:"form-control mt-1 block w-full",options:y.map(a=>({value:a.id,label:a.raison_sociale})),value:y.map(a=>({value:a.id,label:a.raison_sociale})).find(a=>a.value===s.fournisseur_id),onChange:a=>{const r=[...i];r[l].fournisseur_id=a.value,m(r)},required:!0})})}),e.jsx("td",{children:e.jsx(v,{type:"number",className:"mt-1 block w-full",value:s.sac_jute,placeholder:"Ex : 10",onChange:a=>{const r=[...i];r[l].sac_jute=a.target.value,m(r)},required:!0})}),e.jsx("td",{children:e.jsx(v,{type:"number",className:"mt-1 block w-full",value:s.sac_pp,placeholder:"Ex : 10",onChange:a=>{const r=[...i];r[l].sac_pp=a.target.value,m(r)},min:0,required:!0})}),e.jsx("td",{children:e.jsx(v,{type:"number",className:"mt-1 block w-full",value:s.tonnage,placeholder:"Ex : 10",onChange:a=>{const r=[...i];r[l].tonnage=a.target.value,m(r)},min:0,required:!0})}),e.jsx("td",{children:e.jsx(v,{type:"number",className:"mt-1 block w-full",value:s.prix_achat,placeholder:"Ex : 75.000",onChange:a=>{const r=[...i];r[l].prix_achat=a.target.value,m(r)},min:1,required:!0})}),e.jsx("td",{className:"items-center",children:e.jsxs("button",{className:"btn btn-sm btn-danger shadow-sm rounded",onClick:()=>H(s.id),children:[" ",e.jsx(d,{icon:$})," "]})})]},l)):e.jsx("tr",{className:"text-center",children:e.jsxs("td",{colSpan:7,children:["Aucune ligne disponible ",e.jsx(o,{className:"mt-2",message:c.details})]})})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{htmlFor:"observation",value:"Observation",children:" "}),e.jsx(A,{id:"observation",type:"text",className:"mt-1 block w-full form-control",placeholder:"Laissez une observation ici ...",value:u.observation,onChange:s=>n("observation",s.target.value),autoComplete:"observation"}),e.jsx(o,{className:"mt-2",message:c.observation})]})})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(U,{disabled:L,children:[" ",e.jsx(d,{icon:W})," ",L?"Enregistrement ...":"Enregistrer"," "]})})]})]})})})})]})}export{xe as default};
